<div class="bb-quick-pick" bb-wait-for="quickEmptybasket()" bb-wait-var="all_done" ng-if="all_done" bb-form-data-store bb-page>
  <uib-tabset>
    <uib-tab>
      <uib-tab-heading>
        <i class="fa fa-calendar-plus-o"></i> Make booking
      </uib-tab-heading>
      <br/>

      <!-- Make booking tab START -->
      <div ng-form name="appointment-booking-form">
    <h1>Make a Booking</h1>
        <div bb-services>
          <div class="form-group">
            <label translate="ITEM_SERVICE"></label>

            <!-- TODO use display_name -->
            <select id="service" ng-model="service" ng-options="s.name for s in bookable_services | orderBy: 'order'" class="form-control">
              <option value="">-- {{'SELECT_A_SERVICE' | translate}} --</option>
            </select>
        
          </div>
        </div>

        <button type="button" class="btn btn-primary" ng-click="checkReady() && routeReady('calendar')" bb-debounce ng-disabled="!bb.current_item.service" translate="PROGRESS_BOOK"></button>
      </div>
      <!-- Make booking tab END -->

    </uib-tab>
    <uib-tab ng-show="!bb.hide_block">
      <uib-tab-heading>
        <i class="fa fa-calendar-minus-o"></i> Block time
      </uib-tab-heading>
      <br/>
      <!-- Block time tab START -->
      <div ng-form name="block_time_form" class="bb-block-time" bb-block-time>

    <h1>Block Time</h1>
        <div class="form-group" ng-class="{'has-error': resourceError}">
          <label translate="FOR_SERVICE"></label>
          <select id="resource" ng-model="picked_resource" ng-change="changeResource()" ng-options="item.identifier as item.name group by item.group for item in resources" class="form-control">
            <option value="">-- {{'SELECT_A_SERVICE' | translate}} --</option>
          </select>
          <p class="text-danger" ng-init="resourceError=false" ng-show="resourceError" translate="SELECT_RESOURCE"></p>
        </div>
        <div class="form-group" ng-init="blockWholeDay = false" ng-hide="hideBlockAllDay">
          <label>{{'BLOCK_WHOLE_DAY' | translate}} &nbsp;&nbsp;<toggle-switch ng-model="blockWholeDay" ng-change="changeBlockDay(blockWholeDay)" class="switch-primary switch-small" on-label="{{'YES'|translate}}" off-label="{{'NO'|translate}}"></toggle-switch></label>
        </div>
        <div class="row" ng-hide="blockWholeDay">
          <div class="col-md-6">
            <div class="form-group">
              <label translate="ITEM_FROM"></label>
              <div bb-date-time-picker date="config.from_datetime" max-date="config.to_datetime" min-date="config.min_date"></div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label translate="ITEM_TO"></label>
              <div bb-date-time-picker date="config.to_datetime" min-date="config.from_datetime" max-date="config.max_date"></div>
            </div>
          </div>
        </div>


        <div ng-show="block_questions && block_questions.hasQuestions" ng-form name="booking_questions_form" class="bb-form" role="form" novalidate>

          <div class="form-group row" ng-repeat="question in block_questions.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{'has-error': booking_questions_form['q' + question.id].$invalid && (booking_questions_form['q' + question.id].$dirty || booking_form.submitted)}">
            <label for="{{question.id}}" class="control-label col-sm-4" ng-hide="question.detail_type == 'check'">{{question.name}}<span ng-show="question.required">*</span></label>
            <div ng-show="question.detail_type == 'check'" class="col-sm-4 hidden-xs">&nbsp;</div>
            <div class="col-sm-5">
              <input bb-question="question"/><span ng-show="question.detail_type == 'check' && question.required">*</span>
            </div>
            <div class="col-sm-offset-4 messages">
              <div class="error-message" ng-show="booking_questions_form['q' + question.id].$invalid && ( booking_questions_form['q' + question.id].$dirty || booking_form.submitted )">
                This field is required
              </div>
            </div>
          </div>

        </div><!--booking_questions_form-->

        <button type="button" class="btn btn-primary" ng-click="blockTime()" bb-debounce ng-disabled="false" translate="BLOCK_TIME"></button>

      </div>
      <!-- Block time tab END -->

    </uib-tab>
  </uib-tabset>
</div>
