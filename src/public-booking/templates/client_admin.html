<div bb-admin-booking-clients ng-init="per_page=50" class="bb-admin-client">

    <div class="page-intro">
      <h2 class="section-title"><span translate="CLIENT_DETAILS_TITLE"></h2>
      <p><span translate="CLIENT_DETAILS_INSTRUCTION"></span>.</p>
    </div>

    <div class="bb-button-headers">
      <div class="row">
        <div class="col-xs-6">
          <button type="button" class="btn btn-default btn-block" bb-debounce ng-click="showSearch()"><span translate="CLIENT_DETAILS_SEARCH"></span></button>
        </div>
        <div class="col-xs-6">
          <button type="button" class="btn btn-default btn-block" bb-debounce ng-click="showClientForm()"><span translate="CLIENT_DETAILS_ENTER"></span></button>
        </div>
      </div>
    </div>

    <div ng-show="!newClient">
      <div ng-form="client_search_form" class="form-horizontal">
        <label for="search" class="col-xs-offset-4 col-xs-8"><p><span translate="CLIENT_DETAILS_SEARCH_BY_NAME_OR_EMAIL"></span></p></label>
        <form ng-submit="getClients(null, searchText)">
          <div class="col-xs-offset-2 col-xs-8 input-group input-group-lg">
            <input type="search" name="search" id"search" ng-model="searchText" class="form-control"/>
            <span class="input-group-btn">
              <button type="submit" class="btn btn-primary input-lg" bb-debounce><span translate="PROGRESS_SEARCH"></span></button>
            </span>
          </div>
        </form>
         <div class="col-sm-offset-2 messages">
          <div class="error-message" ng-show="search_error">
            <span translate="CLIENT_DETAILS_SEARCH_ERROR"></span>.<br/>
            <span translate="PLEASE_TRY_AGAIN"></span>.
          </div>          
         </div>
       </div>

      <br clear='all'/>
      <div ng-if="clients">
        <h2 class="section-title"><span translate="RESULTS"></span></h2>
        <table tr-ng-grid="" items="clients" enable-filtering="false" enable-sorting="true" order-by="name" page-items="10" selection-mode="0">
          <thead>
            <tr>
              <th field-name="name" enable-filtering="false" enable-sorting="true"></th>
              <th field-name="email" enable-filtering="false" enable-sorting="true"></th>
              <th field-name="address" enable-filtering="false" enable-sorting="false"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td field-name="name" ng-bind="gridItem.name"></td>
              <td field-name="email" ng-bind="gridItem.email"></td>
              <td field-name="address" ng-bind-html="gridItem | address_multi_line"></td>
              <td>
                <button class="btn btn-primary btn-block" ng-click="selectClient(gridItem)"><span translate="PROGRESS_SELECT"></span></button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>

    <div ng-show="newClient">
      <div ng-form name="client_form" class="form-horizontal" role="form" novalidate>

        <div class="form-group" ng-class="{'has-error': client_form.first_name.$invalid && client_form.submitted}">
          <label for="first_name" class="control-label col-sm-4"><span translate="DETAILS_FIRST_NAME"></span>:</label>
          <div class="col-sm-5">
            <input type="text" name="first_name" id"first_name" ng-model="client.first_name" class="form-control" ng-required="!client.email"/>
          </div>
          <div class="col-sm-offset-4 messages">
            <div class="error-message" translate="PLEASE_ENTER_FIRST_NAME"
                 ng-show="client_form.first_name.$invalid && client_form.submitted">
            </div>
          </div>
          <div class="col-sm-offset-4 messages">
            <div translate="PLEASE_ENTER_SOMETHING" ng-hide="client_form.first_name.$invalid && client_form.submitted">
            </div>
          </div>
        </div>

        <div class="form-group" ng-class="{'has-error': client_form.last_name.$invalid && client_form.submitted}">
          <label for="last_name" class="control-label col-sm-4"><span details="DETAILS_FIRST_NAME"></span>:</label>
          <div class="col-sm-5">
            <input type="text" name="last_name" id="last_name" ng-model="client.last_name" class="form-control" ng-required="client.first_name"/>
          </div>
          <div class="col-sm-offset-4 messages">
            <div class="error-message" translate="PLEASE_ENTER_LAST_NAME"
                 ng-show="client_form.last_name.$invalid && client_form.submitted">
            </div>
          </div>
        </div>

        <div class="form-group" ng-class="{'has-error': client_form.email.$invalid && client_form.submitted}">
          <label for="email" class="control-label col-sm-4"><span translate="DETAILS_EMAIL"></span>:</label>
          <div class="col-sm-5">
            <input type="email" name="email" id="email" ng-model="client.email" class="form-control" ng-required="!client.first_name"/>
          </div>
          <div class="col-sm-offset-4 messages">
            <div class="error-message" ng-show="client_form.email.$invalid && client_form.submitted"><span translate="DETAILS_EMAIL_VALIDATION_MSG"></span>
            </div>          
          </div>
        </div>

        <div class="form-group" ng-class="{'has-error': client_form.phone.$invalid && client_form.submitted}">
          <label for="phone" class="control-label col-sm-4"><span translate="DETAILS_PHONE_MOBILE"></span>:</label>
          <div class="col-sm-5">
            <input type="text" name="mobile" id="mobile" ng-model="client.mobile" class="form-control"/>
          </div>
        </div>

        <div ng-show="bb.company_settings.ask_address">
           <div class="form-group" ng-class="{'has-error': client_form.address1.$invalid && ((client_form.address1.$dirty && !client_form.address1.$focused) || booking_form.submitted)}">
              <label for="address1" class="control-label col-sm-4" translate="DETAILS_ADDRESS"></label>
              <div class="col-sm-5">
                <input type="text" name="address1" id="address1" ng-model="client.address1" class="form-control"/>
              </div>
              <div class="col-sm-3 messages">
                <div class="error-message" translate="DETAILS_ADDRESS_VALIDATION_MSG"
                     ng-show="client_form.address1.$invalid && booking_form.submitted">
                </div>
              </div>
            </div>

            <div class="form-group" ng-class="{'has-error': client_form.address2.$invalid && ((client_form.address2.$dirty && !client_form.address2.$focused) || booking_form.submitted)}">
              <label for="address2" class="control-label col-sm-4"></label>
              <div class="col-sm-5">
                <input type="text" name="address2" id="address2" ng-model="client.address2" class="form-control"/>
              </div>
            </div>

            <div class="form-group" ng-class="{'has-error': client_form.address3.$invalid && ((client_form.address3.$dirty && !client_form.address3.$focused) || booking_form.submitted)}">
              <label for="address3" class="control-label col-sm-4" translate="DETAILS_TOWN"></label>
              <div class="col-sm-5">
                <input type="text" name="address3" id="address3" ng-model="client.address3" class="form-control"/>
              </div>
            </div>

            <div class="form-group" ng-class="{'has-error': client_form.address4.$invalid && booking_form.submitted}">
              <label for="address4" class="control-label col-sm-4" translate="DETAILS_COUNTY"></label>
              <div class="col-sm-5">
                <input type="text" name="address4" id="address4" ng-model="client.address4" class="form-control"/>
              </div>
            </div>

            <div class="form-group" ng-class="{'has-error': client_form.postcode.$invalid && ((client_form.postcode.$dirty && !client_form.postcode.$focused) || booking_form.submitted)}">
              <label for="postcode" class="control-label col-sm-4" translate="DETAILS_POSTCODE"></label>
              <div class="col-sm-5">
                <input type="text" name="postcode" id="postcode" ng-model="client.postcode" class="form-control"/>
              </div>
            </div>
        </div>

        <div bb-client-details ng-show="client_details.hasQuestions">

<!--           <div class="form-group" ng-repeat="question in client_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{ 'check': question.detail_type == 'check', 'has-error': client_form['q' + question.id].$invalid && client_form.submitted}"> -->
<!--           <div class="form-group" ng-repeat="question in client_details.questions" ng-if="question.currentlyShown" bb-question-line ng-class="{ 'check': question.detail_type == 'check', 'has-error': question.required && client_form.submitted}">
            <label ng-hide="question.detail_type == 'check'" for="{{question.id}}" class="control-label col-sm-4">{{question.name}}<span ng-show="question.required">*</span></label>
            <div ng-show="question.detail_type == 'check'" class="col-sm-4 hidden-xs">&nbsp;</div>
            <div class="col-sm-5">
              <input bb-question="question"/>
            </div>
            <div class="col-sm-offset-4 messages">
              <div class="error-message" ng-show="question.required && client_form.submitted">
                This field is required
              </div>
            </div>
          </div>
 -->
        </div>

      </div><!--client_form-->

      <div class="bb-step-navigation">
        <div class="row">
          <div class="pull-right col-sm-push-2 forward">
            <button type="submit" class="btn btn-primary" ng-click="validator.validateForm(client_form) && createClient()" bb-debounce><span translate="CLIENT_DETAILS_CREATE"></span></button>
          </div>
          <div class="col-sm-2 col-sm-pull-10 back">
          </div>
        </div>
      </div>

    </div>

  </div>
